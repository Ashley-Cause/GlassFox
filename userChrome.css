/* General Sizing */
:root {
  --transparent-bg-dark: rgba(0, 0, 0, 0.2);
  --transparent-bg-light: rgba(255, 255, 255, .05);
  --browser-padding: 10px;
  --border-radius: 5px;
  &:not([inFullscreen="true"]) {
    --toolbar-bgcolor: tranparent !important;
  }
}

/* Transparency/Translucency */
@media not (-moz-bool-pref: "glassfox.transparency.disabled") {
  :is(body > *,
  #navigator-toolbox,
  #browser) {
    appearance: -moz-window-titlebar !important;
    &:not(#customization-container) > * {
      box-shadow: 1px 1px 5px rgba(0, 0, 0, .4);
    }
  }
}

/* 
General Browser Styling
  - Spacing
    - Gap
    - Padding
  - Rounded Borders
*/
:root:not([inDOMFullscreen]) {
  body > #browser, #navigator-toolbox {
    padding: var(--browser-padding) !important;
    gap: var(--browser-padding);

    & > *, sidebar-main {
      border-radius: var(--border-radius) !important;
      border: none !important;
    }
  }
}
body > #browser {
  margin-top: calc(-2 * var(--browser-padding));
  #tabbrowser-tabpanels, #appcontent {
    background-color: transparent !important;
  }
}

/* Style Pads for more visual separation */
tab {
  opacity: .9;
  &[pending="true"] {
    filter: sepia(80%);
    opacity: .7;
    .tab-background {
      background: var(--transparent-bg-dark) !important;
    }
  }
  &:hover {
    opacity: 1 !important;
    @media not (-moz-bool-pref: "glassfox.sidebar.magnification-enabled") {
      .tab-content {
        scale: 1.2;
      }
    }
  }
  &, .tab-background {
    transition: all ease .3s;
  }
  --tab-selected-bgcolor: var(--transparent-bg-light);
  
}

/* Remove Scrollbars */
#vertical-pinned-tabs-container, scrollbox  {
  scrollbar-width: none !important;
}

/* Add border radius to developer tools */
browser[class*="devtools-toolbox"] {
  border-radius: var(--border-radius);
  overflow: hidden !important;
}
splitter[class*="devtools"] {
  display: none !important;
}

/* Hide titlebar and adjust buttonbox as well as sidebar layout when sidebar is enabled */
@media (-moz-bool-pref: "sidebar.verticalTabs") {
  :root {
    #titlebar {
      display: none !important;
    }
    &:not([inFullscreen="true"]) #nav-bar > toolbartabstop:first-child {
      appearance: -moz-window-button-box !important;
      margin: 12px;
    }
    #sidebar-main {
      margin-top: 0px !important;
    }
    &:has(#sidebar-main [expanded]) {
      --sidebar-width: var(--sidebar-expanded-width)
    }
    &[BookmarksToolbarOverlapsBrowser] {
      #PersonalToolbar {
        margin-left: calc(var(--sidebar-width, var(--sidebar-collapsed-width)) + var(--browser-padding)) !important;
      }
      body > #browser > :not(#sidebar-main) {
        margin-top: calc(var(--bookmarks-toolbar-overlapping-browser-height) + var(--browser-padding)) !important;
      }
    }
  }
}

@media (-moz-bool-pref: "glassfox.sidebar.smaller-tabs") {
  tab {
    --tab-size:.7;
  }
}

@media (-moz-bool-pref: "glassfox.sidebar.taller-pinned-tabs") {
  #tabbrowser-tabs > :has(tab) {
    max-height: 50% !important;
  }
}

/* Custom Magnification effect for sidebar */
@media (-moz-bool-pref: "glassfox.sidebar.magnification-enabled") and (-moz-bool-pref: "sidebar.verticalTabs") {
  sidebar-main:not([expanded]) {
    overflow-x: clip;
    #tabbrowser-tabs {
      width:min-content;
      & > :has(tab) {
        max-height: 50% !important;
        & > tab {
          width: calc(100% * var(--tab-scale, 1)) !important;
          --min-width: var(--tab-min-width);
          --min-height: var(--tab-min-height);
          .tab-stack {

            --tab-min-height: calc(var(--min-height) * var(--tab-size, 1));
            .tab-icon-stack {
              transition: scale ease .3s;
              scale: calc(var(--tab-scale, 1) * var(--tab-size, 1));
            }
          }
          
          &:has(+tab+tab:hover), &:is(tab:hover+tab+tab) {
            --tab-scale:  1.05;
          }
          &:has(+tab:hover), &:is(tab:hover+tab) {
            --tab-scale: 1.25;
          }
          &:hover {
            --tab-scale: 1.5;
          }
        }
      }
    }
    @media (-moz-bool-pref: "glassfox.sidebar.tab-preview-on-side") {
      #tab-preview-panel {
        margin-top: calc(-1 * var(--collapsed-tab-width)) !important;
        margin-left: var(--collapsed-tab-width) !important;
      }
    }
  }
}

@media (-moz-bool-pref: "glassfox.sidebar.hide-new-tab-button") {
  #vertical-tabs #newtab-button-container {
    display: none;
  }
}
